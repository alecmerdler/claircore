package claircore

// VulnerabilityReport provides a report of packages and their
// associated vulnerabilities.
type VulnerabilityReport struct {
	// the manifet hash this vulnerability report is describing
	Hash string `json:"manifest_hash"`
	// all discovered packages in this manifest key'd by package id
	Packages map[int]*Package `json:"packages"`
	// all discovered distributions in this manifest key'd by distribution id
	Distributions map[int]*Distribution `json:"distributions"`
	// all discovered repositories in this manifest key'd by repository id
	Repositories map[int]*Repository `json:"repository"`
	// a list of environment details a package was discovered in key'd by package id
	Environments map[int][]*Environment `json:"environments"`
	// all discovered vulnerabilities affecting this manifest
	Vulnerabilities map[int]*Vulnerability `json:"vulnerabilities"`
	// a lookup table associating package ids with 1 or more vulnerability ids. key'd by package id
	PackageVulnerabilities map[int][]int `json:"package_vulnerabilities"`
}
